<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boxing Champion - Idle Manager</title>
    <style>
        :root {
            --color-bg-primary: #1a1a1a;
            --color-bg-secondary: #2d2d2d;
            --color-bg-tertiary: #3d3d3d;
            --color-text-primary: #ffffff;
            --color-text-secondary: #b0b0b0;
            --color-accent: #e74c3c;
            --color-success: #2ecc71;
            --color-warning: #f39c12;
            --color-rare: #3498db;
            --color-epic: #9b59b6;
            --color-legendary: #f1c40f;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: var(--color-text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: var(--color-bg-secondary);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        h1 {
            color: var(--color-accent);
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .resources {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .resource {
            background: var(--color-bg-tertiary);
            padding: 12px 20px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
            border: 2px solid rgba(255,255,255,0.1);
        }

        .resource-icon {
            font-size: 1.5em;
        }

        .resource-value {
            font-size: 1.2em;
            font-weight: bold;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .panel {
            background: var(--color-bg-secondary);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .panel h2 {
            color: var(--color-accent);
            margin-bottom: 15px;
            font-size: 1.5em;
            border-bottom: 2px solid var(--color-accent);
            padding-bottom: 8px;
        }

        .fighter-display {
            grid-column: span 2;
            text-align: center;
            position: relative;
        }

        .fighter-avatar {
            width: 200px;
            height: 200px;
            margin: 20px auto;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--color-accent), #c0392b);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 5em;
            box-shadow: 0 8px 30px rgba(231, 76, 60, 0.4);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }

        .stat-item {
            background: var(--color-bg-tertiary);
            padding: 12px;
            border-radius: 8px;
            border-left: 4px solid var(--color-accent);
        }

        .stat-name {
            color: var(--color-text-secondary);
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.3em;
            font-weight: bold;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--color-bg-tertiary);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--color-accent), var(--color-warning));
            transition: width 0.3s ease;
        }

        .btn {
            width: 100%;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--color-accent), #c0392b);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--color-success), #27ae60);
            color: white;
        }

        .btn-success:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(46, 204, 113, 0.4);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .training-list, .upgrade-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .training-item, .upgrade-item {
            background: var(--color-bg-tertiary);
            padding: 15px;
            border-radius: 8px;
            border: 2px solid rgba(255,255,255,0.05);
            transition: border-color 0.3s ease;
        }

        .training-item:hover, .upgrade-item:hover {
            border-color: var(--color-accent);
        }

        .training-header, .upgrade-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .training-name, .upgrade-name {
            font-weight: bold;
            font-size: 1.1em;
        }

        .training-time {
            color: var(--color-warning);
            font-size: 0.9em;
        }

        .training-bonus {
            color: var(--color-success);
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .cost {
            color: var(--color-text-secondary);
            font-size: 0.9em;
        }

        .fight-log {
            max-height: 300px;
            overflow-y: auto;
            background: var(--color-bg-tertiary);
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .fight-log::-webkit-scrollbar {
            width: 8px;
        }

        .fight-log::-webkit-scrollbar-track {
            background: var(--color-bg-secondary);
        }

        .fight-log::-webkit-scrollbar-thumb {
            background: var(--color-accent);
            border-radius: 4px;
        }

        .log-entry {
            margin-bottom: 8px;
            padding: 5px;
            border-left: 3px solid var(--color-accent);
            padding-left: 10px;
        }

        .log-win {
            border-left-color: var(--color-success);
            color: var(--color-success);
        }

        .log-loss {
            border-left-color: var(--color-accent);
            color: var(--color-accent);
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .card {
            background: var(--color-bg-tertiary);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            border: 2px solid rgba(255,255,255,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
        }

        .card.rare {
            border-color: var(--color-rare);
        }

        .card.epic {
            border-color: var(--color-epic);
        }

        .card.legendary {
            border-color: var(--color-legendary);
        }

        .card-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .card-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .card-rarity {
            font-size: 0.8em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab {
            padding: 10px 20px;
            background: var(--color-bg-tertiary);
            border: none;
            border-radius: 8px 8px 0 0;
            color: var(--color-text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .tab.active {
            background: var(--color-accent);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--color-success);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            animation: slideIn 0.3s ease, slideOut 0.3s ease 2.7s;
            z-index: 1000;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }

        .opponent-info {
            background: var(--color-bg-tertiary);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .opponent-name {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--color-warning);
        }

        .opponent-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            font-size: 0.9em;
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr 1fr;
            }
            .fighter-display {
                grid-column: span 2;
            }
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            .fighter-display {
                grid-column: span 1;
            }
            h1 {
                font-size: 1.8em;
            }
            .resources {
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-top">
                <h1>ü•ä Boxing Champion</h1>
                <div class="resources">
                    <div class="resource">
                        <span class="resource-icon">üí∞</span>
                        <div>
                            <div style="font-size: 0.8em; color: var(--color-text-secondary)">–î–µ–Ω—å–≥–∏</div>
                            <div class="resource-value" id="money">0</div>
                        </div>
                    </div>
                    <div class="resource">
                        <span class="resource-icon">‚≠ê</span>
                        <div>
                            <div style="font-size: 0.8em; color: var(--color-text-secondary)">–°–ª–∞–≤–∞</div>
                            <div class="resource-value" id="fame">0</div>
                        </div>
                    </div>
                    <div class="resource">
                        <span class="resource-icon">‚ö°</span>
                        <div>
                            <div style="font-size: 0.8em; color: var(--color-text-secondary)">–≠–Ω–µ—Ä–≥–∏—è</div>
                            <div class="resource-value" id="energy">10/10</div>
                        </div>
                    </div>
                    <div class="resource">
                        <span class="resource-icon">üèÜ</span>
                        <div>
                            <div style="font-size: 0.8em; color: var(--color-text-secondary)">–†–µ–π—Ç–∏–Ω–≥</div>
                            <div class="resource-value" id="rating">1000</div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <div class="main-content">
            <div class="panel fighter-display">
                <h2>ü•ä –í–∞—à –ë–æ–µ—Ü</h2>
                <div class="fighter-avatar">ü•ä</div>
                <div style="font-size: 1.5em; font-weight: bold; margin-bottom: 10px;" id="fighter-name">–ù–æ–≤–∏—á–æ–∫</div>
                <div style="color: var(--color-text-secondary); margin-bottom: 20px;">–£—Ä–æ–≤–µ–Ω—å <span id="level">1</span> | –û–ø—ã—Ç: <span id="exp">0</span>/<span id="exp-max">100</span></div>
                <div class="progress-bar">
                    <div class="progress-fill" id="exp-bar" style="width: 0%"></div>
                </div>

                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-name">üí™ –°–∏–ª–∞</div>
                        <div class="stat-value" id="stat-power">10</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-name">‚ö° –°–∫–æ—Ä–æ—Å—Ç—å</div>
                        <div class="stat-value" id="stat-speed">10</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-name">‚ù§Ô∏è –í—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å</div>
                        <div class="stat-value" id="stat-stamina">10</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-name">üõ°Ô∏è –ó–∞—â–∏—Ç–∞</div>
                        <div class="stat-value" id="stat-defense">10</div>
                    </div>
                </div>

                <div style="margin-top: 20px;">
                    <div style="color: var(--color-text-secondary); font-size: 0.9em; margin-bottom: 5px;">
                        –ü–æ–±–µ–¥: <span id="wins">0</span> | –ü–æ—Ä–∞–∂–µ–Ω–∏–π: <span id="losses">0</span> | –ù–æ–∫–∞—É—Ç—ã: <span id="knockouts">0</span>
                    </div>
                </div>
            </div>

            <div class="panel">
                <h2>üèãÔ∏è –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h2>
                <div class="training-list" id="training-list"></div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('fights')">‚öîÔ∏è –ë–æ–∏</button>
            <button class="tab" onclick="switchTab('upgrades')">‚¨ÜÔ∏è –£–ª—É—á—à–µ–Ω–∏—è</button>
            <button class="tab" onclick="switchTab('cards')">üé¥ –ö–∞—Ä—Ç—ã</button>
        </div>

        <div class="panel">
            <div id="fights-tab" class="tab-content active">
                <h2>‚öîÔ∏è –ê—Ä–µ–Ω–∞ –ë–æ—ë–≤</h2>
                <div class="opponent-info" id="opponent-info">
                    <div class="opponent-name">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞</div>
                </div>
                <button class="btn btn-primary" onclick="generateOpponent()">üéØ –ù–∞–π—Ç–∏ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞</button>
                <button class="btn btn-success" id="fight-btn" onclick="startFight()" disabled>ü•ä –ù–∞—á–∞—Ç—å –±–æ–π!</button>
                <h3 style="margin-top: 20px; margin-bottom: 10px;">üìú –ñ—É—Ä–Ω–∞–ª –ë–æ—ë–≤</h3>
                <div class="fight-log" id="fight-log">
                    <div class="log-entry">–ñ–¥—ë–º –ø–µ—Ä–≤–æ–≥–æ –±–æ—è...</div>
                </div>
            </div>

            <div id="upgrades-tab" class="tab-content">
                <h2>‚¨ÜÔ∏è –£–ª—É—á—à–µ–Ω–∏—è –ë–æ–π—Ü–∞</h2>
                <div class="upgrade-list" id="upgrade-list"></div>
            </div>

            <div id="cards-tab" class="tab-content">
                <h2>üé¥ –ö–æ–ª–ª–µ–∫—Ü–∏—è –ö–∞—Ä—Ç</h2>
                <p style="color: var(--color-text-secondary); margin-bottom: 15px;">
                    –°–æ–±–∏—Ä–∞–π—Ç–µ –∫–∞—Ä—Ç—ã —Ç—Ä–µ–Ω–µ—Ä–æ–≤, –∑–∞–ª–æ–≤ –∏ —ç–∫–∏–ø–∏—Ä–æ–≤–∫–∏ –¥–ª—è –±–æ–Ω—É—Å–æ–≤!
                </p>
                <div class="card-grid" id="card-grid"></div>
            </div>
        </div>
    </div>

    <script>
        // –ò–≥—Ä–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        const gameState = {
            money: 1000,
            fame: 0,
            energy: 10,
            maxEnergy: 10,
            rating: 1000,
            level: 1,
            exp: 0,
            expToNext: 100,
            stats: {
                power: 10,
                speed: 10,
                stamina: 10,
                defense: 10
            },
            record: {
                wins: 0,
                losses: 0,
                knockouts: 0
            },
            upgrades: {
                power: 0,
                speed: 0,
                stamina: 0,
                defense: 0
            },
            cards: [],
            lastSave: Date.now(),
            currentOpponent: null
        };

        // –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
        const trainings = [
            {
                id: 'power-training',
                name: '–†–∞–±–æ—Ç–∞ –Ω–∞ –º–µ—à–∫–µ',
                icon: 'ü•ä',
                time: 30,
                cost: 100,
                bonus: { power: 1 },
                description: '+1 –°–∏–ª–∞'
            },
            {
                id: 'speed-training',
                name: '–†–∞–±–æ—Ç–∞ –Ω–∞ –ª–∞–ø–∞—Ö',
                icon: '‚ö°',
                time: 30,
                cost: 100,
                bonus: { speed: 1 },
                description: '+1 –°–∫–æ—Ä–æ—Å—Ç—å'
            },
            {
                id: 'stamina-training',
                name: '–ö–∞—Ä–¥–∏–æ',
                icon: 'üèÉ',
                time: 45,
                cost: 150,
                bonus: { stamina: 1 },
                description: '+1 –í—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å'
            },
            {
                id: 'defense-training',
                name: '–°–ø–∞—Ä—Ä–∏–Ω–≥',
                icon: 'üõ°Ô∏è',
                time: 60,
                cost: 200,
                bonus: { defense: 1 },
                description: '+1 –ó–∞—â–∏—Ç–∞'
            }
        ];

        // –£–ª—É—á—à–µ–Ω–∏—è
        const upgrades = [
            { id: 'power', name: '–£–ª—É—á—à–µ–Ω–∏–µ —Å–∏–ª—ã', icon: 'üí™', baseCost: 500, growth: 1.15 },
            { id: 'speed', name: '–£–ª—É—á—à–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏', icon: '‚ö°', baseCost: 500, growth: 1.15 },
            { id: 'stamina', name: '–£–ª—É—á—à–µ–Ω–∏–µ –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç–∏', icon: '‚ù§Ô∏è', baseCost: 500, growth: 1.15 },
            { id: 'defense', name: '–£–ª—É—á—à–µ–Ω–∏–µ –∑–∞—â–∏—Ç—ã', icon: 'üõ°Ô∏è', baseCost: 500, growth: 1.15 }
        ];

        // –ö–∞—Ä—Ç—ã
        const availableCards = [
            { id: 1, name: '–ö–æ–∂–∞–Ω—ã–µ –ø–µ—Ä—á–∞—Ç–∫–∏', icon: 'ü•ä', rarity: 'common', bonus: { power: 2 } },
            { id: 2, name: '–õ–µ–≥–∫–∞—è –æ–±—É–≤—å', icon: 'üëü', rarity: 'common', bonus: { speed: 2 } },
            { id: 3, name: '–¢—Ä–µ–Ω–µ—Ä –î–∂–æ', icon: 'üë®‚Äçüè´', rarity: 'rare', bonus: { power: 5, defense: 3 } },
            { id: 4, name: '–ó–∞–ª "–õ–µ–≥–µ–Ω–¥–∞"', icon: 'üèãÔ∏è', rarity: 'epic', bonus: { stamina: 10 } },
            { id: 5, name: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ –ø–µ—Ä—á–∞—Ç–∫–∏', icon: '‚ú®', rarity: 'legendary', bonus: { power: 15, speed: 10 } }
        ];

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function init() {
            loadGame();
            renderTrainings();
            renderUpgrades();
            renderCards();
            updateUI();
            startAutoSave();
            startEnergyRegen();
        }

        // –†–µ–Ω–¥–µ—Ä —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
        function renderTrainings() {
            const container = document.getElementById('training-list');
            container.innerHTML = trainings.map(training => `
                <div class="training-item">
                    <div class="training-header">
                        <span class="training-name">${training.icon} ${training.name}</span>
                        <span class="training-time">${training.time}—Å</span>
                    </div>
                    <div class="training-bonus">${training.description}</div>
                    <div class="cost">–°—Ç–æ–∏–º–æ—Å—Ç—å: ${training.cost} üí∞</div>
                    <button class="btn btn-success" onclick="startTraining('${training.id}')">
                        –ù–∞—á–∞—Ç—å
                    </button>
                </div>
            `).join('');
        }

        // –†–µ–Ω–¥–µ—Ä —É–ª—É—á—à–µ–Ω–∏–π
        function renderUpgrades() {
            const container = document.getElementById('upgrade-list');
            container.innerHTML = upgrades.map(upgrade => {
                const level = gameState.upgrades[upgrade.id];
                const cost = Math.floor(upgrade.baseCost * Math.pow(upgrade.growth, level));
                return `
                    <div class="upgrade-item">
                        <div class="upgrade-header">
                            <span class="upgrade-name">${upgrade.icon} ${upgrade.name}</span>
                            <span style="color: var(--color-warning)">Lvl ${level}</span>
                        </div>
                        <div class="cost">–°—Ç–æ–∏–º–æ—Å—Ç—å: ${cost} üí∞</div>
                        <button class="btn btn-primary" onclick="buyUpgrade('${upgrade.id}')">
                            –ö—É–ø–∏—Ç—å (+${Math.floor(5 * (1 + level * 0.1))})
                        </button>
                    </div>
                `;
            }).join('');
        }

        // –†–µ–Ω–¥–µ—Ä –∫–∞—Ä—Ç
        function renderCards() {
            const container = document.getElementById('card-grid');
            container.innerHTML = availableCards.map(card => {
                const owned = gameState.cards.includes(card.id);
                return `
                    <div class="card ${card.rarity} ${owned ? '' : 'locked'}" 
                         onclick="${owned ? '' : `buyCard(${card.id})`}">
                        <div class="card-icon">${card.icon}</div>
                        <div class="card-name">${card.name}</div>
                        <div class="card-rarity" style="color: var(--color-${card.rarity})">${card.rarity}</div>
                        ${owned ? '<div style="color: var(--color-success); margin-top: 5px;">‚úî –í –∫–æ–ª–ª–µ–∫—Ü–∏–∏</div>' : '<div style="margin-top: 5px;">üí∞ ' + (card.rarity === 'legendary' ? '50000' : card.rarity === 'epic' ? '10000' : card.rarity === 'rare' ? '3000' : '1000') + '</div>'}
                    </div>
                `;
            }).join('');
        }

        // –°—Ç–∞—Ä—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
        function startTraining(id) {
            const training = trainings.find(t => t.id === id);
            if (gameState.money < training.cost) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!', 'error');
                return;
            }

            gameState.money -= training.cost;
            showNotification(`–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –Ω–∞—á–∞—Ç–∞: ${training.name}`);

            setTimeout(() => {
                for (const [stat, value] of Object.entries(training.bonus)) {
                    gameState.stats[stat] += value;
                }
                addExp(20);
                showNotification(`–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! ${training.description}`);
                updateUI();
            }, training.time * 1000);

            updateUI();
        }

        // –ü–æ–∫—É–ø–∫–∞ —É–ª—É—á—à–µ–Ω–∏—è
        function buyUpgrade(id) {
            const upgrade = upgrades.find(u => u.id === id);
            const level = gameState.upgrades[id];
            const cost = Math.floor(upgrade.baseCost * Math.pow(upgrade.growth, level));

            if (gameState.money < cost) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!', 'error');
                return;
            }

            gameState.money -= cost;
            gameState.upgrades[id]++;
            gameState.stats[id] += Math.floor(5 * (1 + level * 0.1));
            
            showNotification(`–£–ª—É—á—à–µ–Ω–∏–µ –∫—É–ø–ª–µ–Ω–æ!`);
            renderUpgrades();
            updateUI();
        }

        // –ü–æ–∫—É–ø–∫–∞ –∫–∞—Ä—Ç—ã
        function buyCard(id) {
            const card = availableCards.find(c => c.id === id);
            const cost = card.rarity === 'legendary' ? 50000 : card.rarity === 'epic' ? 10000 : card.rarity === 'rare' ? 3000 : 1000;

            if (gameState.money < cost) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!', 'error');
                return;
            }

            gameState.money -= cost;
            gameState.cards.push(id);
            
            for (const [stat, value] of Object.entries(card.bonus)) {
                gameState.stats[stat] += value;
            }

            showNotification(`–ö–∞—Ä—Ç–∞ –ø–æ–ª—É—á–µ–Ω–∞: ${card.name}!`);
            renderCards();
            updateUI();
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞
        function generateOpponent() {
            const names = ['–ò–≤–∞–Ω –°–∏–ª—å–Ω—ã–π', '–ú–∏–∫–µ –¢–∞–π—Å–æ–Ω', '–î–∂–æ –§—Ä—ç–π–∑–µ—Ä', '–ú—É—Ö–∞–º–º–µ–¥ –ê–ª–∏', '–†–æ–∫–∫–∏ –ë–∞–ª—å–±–æ–∞'];
            const variance = 0.8 + Math.random() * 0.4; // 0.8-1.2
            
            gameState.currentOpponent = {
                name: names[Math.floor(Math.random() * names.length)],
                power: Math.floor(gameState.stats.power * variance),
                speed: Math.floor(gameState.stats.speed * variance),
                stamina: Math.floor(gameState.stats.stamina * variance),
                defense: Math.floor(gameState.stats.defense * variance),
                rating: gameState.rating + Math.floor((Math.random() - 0.5) * 200)
            };

            const info = document.getElementById('opponent-info');
            info.innerHTML = `
                <div class="opponent-name">ü•ä ${gameState.currentOpponent.name}</div>
                <div class="opponent-stats">
                    <div>üí™ –°–∏–ª–∞: ${gameState.currentOpponent.power}</div>
                    <div>‚ö° –°–∫–æ—Ä–æ—Å—Ç—å: ${gameState.currentOpponent.speed}</div>
                    <div>‚ù§Ô∏è –í—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å: ${gameState.currentOpponent.stamina}</div>
                    <div>üõ°Ô∏è –ó–∞—â–∏—Ç–∞: ${gameState.currentOpponent.defense}</div>
                    <div style="grid-column: span 2; margin-top: 5px;">üèÜ –†–µ–π—Ç–∏–Ω–≥: ${gameState.currentOpponent.rating}</div>
                </div>
            `;
            document.getElementById('fight-btn').disabled = false;
        }

        // –°–∏–º—É–ª—è—Ü–∏—è –±–æ—è
        function startFight() {
            if (gameState.energy < 1) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç–Ω–µ—Ä–≥–∏–∏!', 'error');
                return;
            }

            if (!gameState.currentOpponent) {
                showNotification('–°–Ω–∞—á–∞–ª–∞ –Ω–∞–π–¥–∏—Ç–µ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞!', 'error');
                return;
            }

            gameState.energy--;
            
            const player = gameState.stats;
            const opponent = gameState.currentOpponent;
            
            const playerScore = player.power + player.speed + player.stamina + player.defense;
            const opponentScore = opponent.power + opponent.speed + opponent.stamina + opponent.defense;
            
            const playerChance = playerScore / (playerScore + opponentScore);
            const win = Math.random() < playerChance;
            
            const log = document.getElementById('fight-log');
            
            if (win) {
                const knockout = Math.random() < 0.3;
                gameState.record.wins++;
                if (knockout) gameState.record.knockouts++;
                
                const reward = Math.floor(200 + Math.random() * 300);
                const fameReward = Math.floor(10 + Math.random() * 20);
                const ratingGain = Math.floor(15 + Math.random() * 25);
                
                gameState.money += reward;
                gameState.fame += fameReward;
                gameState.rating += ratingGain;
                addExp(50);
                
                log.innerHTML = `<div class="log-entry log-win">
                    üèÜ –ü–û–ë–ï–î–ê${knockout ? ' –ù–û–ö–ê–£–¢–û–ú!' : '!'} –ø—Ä–æ—Ç–∏–≤ ${opponent.name}<br>
                    üí∞ +${reward} | ‚≠ê +${fameReward} | üèÜ +${ratingGain}
                </div>` + log.innerHTML;
                
                showNotification(`–ü–æ–±–µ–¥–∞${knockout ? ' –Ω–æ–∫–∞—É—Ç–æ–º' : ''}!`);
            } else {
                gameState.record.losses++;
                const ratingLoss = Math.floor(10 + Math.random() * 15);
                gameState.rating = Math.max(0, gameState.rating - ratingLoss);
                addExp(15);
                
                log.innerHTML = `<div class="log-entry log-loss">
                    ‚ùå –ü–û–†–ê–ñ–ï–ù–ò–ï –æ—Ç ${opponent.name}<br>
                    üèÜ -${ratingLoss}
                </div>` + log.innerHTML;
                
                showNotification('–ü–æ—Ä–∞–∂–µ–Ω–∏–µ...', 'error');
            }
            
            gameState.currentOpponent = null;
            document.getElementById('fight-btn').disabled = true;
            document.getElementById('opponent-info').innerHTML = `
                <div class="opponent-name">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞</div>
            `;
            
            updateUI();
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–ø—ã—Ç–∞
        function addExp(amount) {
            gameState.exp += amount;
            while (gameState.exp >= gameState.expToNext) {
                gameState.exp -= gameState.expToNext;
                gameState.level++;
                gameState.expToNext = Math.floor(gameState.expToNext * 1.5);
                
                // –ë–æ–Ω—É—Å –ø—Ä–∏ –ø–æ–≤—ã—à–µ–Ω–∏–∏ —É—Ä–æ–≤–Ω—è
                gameState.stats.power += 2;
                gameState.stats.speed += 2;
                gameState.stats.stamina += 2;
                gameState.stats.defense += 2;
                gameState.maxEnergy += 1;
                gameState.energy = gameState.maxEnergy;
                
                showNotification(`üéâ –ù–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å: ${gameState.level}!`);
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
        function updateUI() {
            document.getElementById('money').textContent = Math.floor(gameState.money).toLocaleString();
            document.getElementById('fame').textContent = Math.floor(gameState.fame).toLocaleString();
            document.getElementById('energy').textContent = `${gameState.energy}/${gameState.maxEnergy}`;
            document.getElementById('rating').textContent = Math.floor(gameState.rating).toLocaleString();
            document.getElementById('level').textContent = gameState.level;
            document.getElementById('exp').textContent = Math.floor(gameState.exp);
            document.getElementById('exp-max').textContent = gameState.expToNext;
            
            const expPercent = (gameState.exp / gameState.expToNext) * 100;
            document.getElementById('exp-bar').style.width = expPercent + '%';
            
            document.getElementById('stat-power').textContent = Math.floor(gameState.stats.power);
            document.getElementById('stat-speed').textContent = Math.floor(gameState.stats.speed);
            document.getElementById('stat-stamina').textContent = Math.floor(gameState.stats.stamina);
            document.getElementById('stat-defense').textContent = Math.floor(gameState.stats.defense);
            
            document.getElementById('wins').textContent = gameState.record.wins;
            document.getElementById('losses').textContent = gameState.record.losses;
            document.getElementById('knockouts').textContent = gameState.record.knockouts;
        }

        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            notification.style.background = type === 'error' ? 'var(--color-accent)' : 'var(--color-success)';
            document.body.appendChild(notification);
            setTimeout(() => notification.remove(), 3000);
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tab + '-tab').classList.add('active');
        }

        // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
        function startAutoSave() {
            setInterval(() => {
                localStorage.setItem('boxingGame', JSON.stringify(gameState));
            }, 30000);
        }

        // –†–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–Ω–µ—Ä–≥–∏–∏
        function startEnergyRegen() {
            setInterval(() => {
                if (gameState.energy < gameState.maxEnergy) {
                    gameState.energy++;
                    updateUI();
                }
            }, 60000); // 1 –º–∏–Ω—É—Ç–∞
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä—ã
        function loadGame() {
            const saved = localStorage.getItem('boxingGame');
            if (saved) {
                const data = JSON.parse(saved);
                Object.assign(gameState, data);
                
                // –û—Ñ—Ñ–ª–∞–π–Ω –ø—Ä–æ–≥—Ä–µ—Å—Å
                const offlineTime = Date.now() - gameState.lastSave;
                const offlineMinutes = Math.floor(offlineTime / 60000);
                if (offlineMinutes > 0) {
                    const offlineIncome = Math.min(offlineMinutes * 10, 1000);
                    gameState.money += offlineIncome;
                    showNotification(`–û—Ñ—Ñ–ª–∞–π–Ω –¥–æ—Ö–æ–¥: +${offlineIncome} üí∞`);
                }
            }
            gameState.lastSave = Date.now();
        }

        // –ó–∞–ø—É—Å–∫
        window.addEventListener('load', init);
        window.addEventListener('beforeunload', () => {
            localStorage.setItem('boxingGame', JSON.stringify(gameState));
        });
    </script>
</body>
</html>